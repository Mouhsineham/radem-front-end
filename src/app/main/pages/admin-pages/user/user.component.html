<div id="add-users">
    <nav aria-label="breadcrumb" class="doNotPrint">
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="/admin"><i class="icon-settings"></i>{{'ADMINISTRATION' |
                translate}}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{'USER_MANAGEMENT' | translate}}</li>
        </ul>
    </nav>
    <div class="container-fluid">
        <div class="spacer"></div>
        <div class="card">
            <div class="card-body">
                <section>
                    <div class="doNotPrint">
                        <h4 class="card-title text-muted" *ngIf="!user?.id">{{'ADD_A_NEW_USER' | translate}}</h4>
                        <h4 class="card-title text-muted" *ngIf="user?.id">{{'EDIT_USER' | translate}} :
                            {{user.username}}</h4>
                    </div>
                    <form [formGroup]="modalForm" (ngSubmit)='saveUser(modalForm)' novalidate>
                        <tabset [justified]="true">
                            <tab heading="Profil" class="active">
                                <div class="container-fluid">
                                    <div class="form-group row required">
                                        <label for="firstname" class="col-sm-3 col-form-label">{{'FIRST_NAME' |
                                            translate}}</label>
                                        <div class="col-sm-9">
                                            <input type="text"
                                                   class="form-control"
                                                   id="firstname"
                                                   placeholder="Prénom"
                                                   formControlName="firstname">
                                            <div class="text-danger"
                                                 *ngIf="!modalForm.controls['firstname'].valid && modalForm.controls['firstname'].touched">
                                                <div *ngIf="modalForm.controls['firstname'].errors.required">
                                                    {{'THE_FIRST_NAME_IS_REQUIRED' | translate}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row required">
                                        <label for="firstname" class="col-sm-3 col-form-label">{{'LAST_NAME' |
                                            translate}}</label>
                                        <div class="col-sm-9">
                                            <input type="text"
                                                   class="form-control"
                                                   id="lastname"
                                                   placeholder="Nom"
                                                   formControlName="lastname"
                                                   required>
                                            <div class="text-danger"
                                                 *ngIf="!modalForm.controls['lastname'].valid && modalForm.controls['lastname'].touched">
                                                <div *ngIf="modalForm.controls['lastname'].errors.required">
                                                    {{'THE_NAME_IS_REQUIRED' | translate}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--<div class="form-group row required">-->
                                        <!--<label for="username" class="col-sm-3 col-form-label">{{'USERNAME' |-->
                                            <!--translate}}</label>-->
                                        <!--<div class="col-sm-9">-->
                                            <!--<input type="text"-->
                                                   <!--class="form-control"-->
                                                   <!--id="username"-->
                                                   <!--placeholder="Nom de l'utilisateur"-->
                                                   <!--formControlName="username"-->
                                                   <!--required>-->
                                            <!--<div class="text-danger"-->
                                                 <!--*ngIf="!modalForm.controls['username'].valid && modalForm.controls['username'].touched">-->
                                                <!--<div *ngIf="modalForm.controls['username'].errors.required">-->
                                                    <!--{{'THE_USERNAME_IS_REQUIRED' | translate}}-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <div class="form-group row required">
                                        <label for="email" class="col-sm-3 col-form-label">{{'MAIL' |
                                            translate}}</label>
                                        <div class="col-sm-9">
                                            <input type="email"
                                                   class="form-control"
                                                   id="email"
                                                   placeholder="{{'MAIL' | translate}}"
                                                   formControlName="email"
                                                   required>
                                            <div class="text-danger"
                                                 *ngIf="!modalForm.controls['email'].valid && modalForm.controls['email'].touched">
                                                <div *ngIf="modalForm.controls['email'].errors.required">
                                                    {{'EMAIL_IS_REQUIRED' | translate}}
                                                </div>
                                                <div *ngIf="modalForm.controls['email'].errors.pattern">
                                                    {{'THE_EMAIL_IS_INVALID' | translate}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="!user?.id">
                                        <div class="form-group row required">
                                            <label for="password" class="col-sm-3 col-form-label">{{'PASSWORD' |
                                                translate}}</label>
                                            <div class="col-sm-9">
                                                <input type="password"
                                                       class="form-control"
                                                       id="password"
                                                       placeholder="Mot de passe"
                                                       formControlName="password"
                                                       required>
                                                <div class="text-danger"
                                                     *ngIf="!modalForm.controls['password'].valid && modalForm.controls['password'].touched">
                                                    <div *ngIf="modalForm.controls['password'].errors.required">
                                                        {{'PASSWORD_IS_REQUIRED' | translate}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row required">
                                            <label for="passwordConf" class="col-sm-3 col-form-label">
                                                {{'CONFIRM_THE_PASSWORD' | translate}}
                                            </label>
                                            <div class="col-sm-9">
                                                <input type="password"
                                                       class="form-control"
                                                       id="passwordConf"
                                                       placeholder="Mot de passe"
                                                       formControlName="confirmPassword">
                                                <div class="text-danger"
                                                     *ngIf="!modalForm.controls['confirmPassword'].valid && modalForm.controls['confirmPassword'].touched">
                                                    <div *ngIf="modalForm.controls['confirmPassword'].errors.MatchPassword">
                                                        {{'THE_TWO_PASSWORDS_ARE_NOT_IDENTICAL' | translate}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </tab>
                            <tab heading="Bio">
                                <div class="container-fluid">
                                    <!--<div class="form-group row">
                                        <label for="photo" class="col-sm-3 col-form-label">{{'PROFILE_PICTURE' |
                                            translate}}</label>
                                        <div class="col-sm-9">
                                            <div class="card card-photo">
                                                <img [src]="result64 || defaultAvatar" id="img" #img>
                                            </div>
                                            <input type="file"
                                                   id="photo"
                                                   class="form-control"
                                                   formControlName="avatar"
                                                   (change)="onFileChange($event)"
                                                   accept="image/*"
                                                   #fileInput>
                                        </div>
                                    </div>-->
                                    <div class="form-group row">
                                        <label for="address" class="col-sm-3 col-form-label">
                                            {{'ADDRESS' | translate}}</label>
                                        <div class="col-sm-9">
                                         <textarea class="form-control"
                                                   id="address"
                                                   rows="4"
                                                   formControlName="address">
                                         </textarea>
                                        </div>
                                    </div>
                                </div>
                            </tab>
                            <tab heading="Droits d'accès">
                                <div class="container-fluid">
                                    <div class="card my-0">
                                        <div class="card-body">
                                            <h5 class="text-muted">{{'TYPE_OF_ACCOUNT' | translate}}</h5><br/>
                                            <!--<div class="form-group row required">-->
                                                <!--<label for="service" class="col-sm-3 col-form-label">{{'SERVICE' |-->
                                                    <!--translate}}</label>-->
                                                <!--<div class="col-sm-9">-->
                                                    <!--<select id='service'-->
                                                            <!--class="form-control"-->
                                                            <!--formControlName="serviceId"-->
                                                            <!--required>-->
                                                        <!--<option value="">{{'SELECT_VALUE' | translate}}</option>-->
                                                        <!--<option *ngFor="let service of listServices"-->
                                                                <!--value="{{service.id}}">{{service.name}}-->
                                                        <!--</option>-->
                                                    <!--</select>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                            <div class="form-group row required">
                                                <label for="profilType" class="col-sm-3 col-form-label">{{'PROFIL' |
                                                    translate}}</label>
                                                <div class="col-sm-9">
                                                    <select id='profilType'
                                                            (change)="onProfileChange(profileId)"
                                                            class="form-control"
                                                            formControlName="profileId"
                                                            required>
                                                        <option value="">{{'SELECT_VALUE' | translate}}</option>
                                                        <option *ngFor="let c of listProfiles"
                                                                value="{{c.id}}">{{c.title}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <!--<label for="enabled" class="col-sm-3 col-form-label">{{'ACTIVATE_THE_ACCOUNT'-->
                                                    <!--| translate}}</label>-->
                                                <div class="col-sm-9">
                                                    <div class="form-check">
                                                        <input type="checkbox" class="form-check-input" id="enabled"
                                                               formControlName="enabled">
                                                        <label class="form-check-label" for="enabled">
                                                            {{'ACTIVATE_ACCOUNT_OTHERWISE_THE_USER_WILL_NOT_BE_ABLE_TO_ACCESS_HIS_ACCOUNT'
                                                            | translate}}
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!--<div class="card">-->
                                        <!--<div class="card-body">-->
                                            <!--<h5 class="card-title text-muted text-left">{{'ACCESS_RIGHTS' |-->
                                                <!--translate}}</h5>-->
                                            <!--<div class="row">-->
                                                <!--<div *ngFor="let authority of authorities"-->
                                                     <!--class="col-md-6 float-left text-left">-->
                                                    <!--<label>-->
                                                        <!--<input type="checkbox" name="{{authority.id}}"-->
                                                               <!--class="form-group"-->
                                                               <!--[(checklist)]="selectedAuthorities"-->
                                                               <!--[checklistValue]="authority.id">-->
                                                        <!--{{authority.name}}</label>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                </div>
                            </tab>
                        </tabset>
                        <div class="text-right">
                            <button type="button" class="btn btn-secondary" [routerLink]="['/admin/users']"> {{'CANCEL'
                                | translate}}
                            </button>
                            <button class="btn btn-success" [disabled]="modalForm.invalid">{{'SAVE' | translate}}
                            </button>
                        </div>
                    </form>
                </section>
            </div>
        </div>
    </div>
</div>
